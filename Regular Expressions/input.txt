Metformin will reach full effectiveness in 6-8 weeks. It has three primary effects (http://en.wikipedia.org/wiki/Metformin#Mechanism4of_action).

First, it (frequently) reduces the amount of blood sugar produced by your liver, this presumably will decrease your basal needs and help your fasting numbers.

Second, metformin increases the insulin, signaling resulting in increased insulin sensitivity: http://care.diabetesjournals.org/content/27/1/281.full. 
The effect is primarily on the muscle mass in your body.
Insulin resistance also affects all kinds of other stuff, but the biggest utilization of insulin is in the uptake of glucose to muscles.

Third, Metformin decreases the absorption of glucose during digestion.It is this effect that I believe causes some of the gastric issues.